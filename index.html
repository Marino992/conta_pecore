<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Conta le Pecore ‚Äì Mobile</title>
<style>
  * { box-sizing:border-box; margin:0; padding:0; }
  body {
    font-family: "Segoe UI", Tahoma, sans-serif;
    display:flex;
    flex-direction:column;
    align-items:center;
    min-height:100vh;
    background:linear-gradient(135deg, #a0e9fd, #ffffff);
    text-align:center;
    padding:10px;
  }
  h1 { font-size:6vw; margin:10px 0; color:#222; }
  #instructions { font-size:4vw; margin-bottom:20px; max-width:90%; color:#444; }
  #score, #time { font-size:5vw; margin:6px 0; }
  #sheepButton {
    font-size:22vw;
    cursor:pointer;
    transition:all 0.25s ease;
    margin:20px 0;
    user-select:none;
  }
  #message { font-size:5vw; min-height:2em; margin-top:10px; }
  #restartButton {
    display:none;
    margin-top:20px;
    padding:10px 20px;
    font-size:5vw;
    border:0;
    border-radius:12px;
    background:#4CAF50;
    color:white;
    cursor:pointer;
  }
  #restartButton:active { background:#3c9f42; }

  .poop-hide {
    transform:scale(1.5) rotate(360deg);
    opacity:0;
    transition:0.4s;
  }
</style>
</head>
<body>

<h1>Conta le Pecore üêë</h1>
<p id="instructions">Tocca le pecore per fare punti! Evita la üí© o perdi! Hai 30 secondi!</p>

<div id="score">üêëPecore: 0</div>
<div id="time">‚è±Ô∏è Tempo: 30</div>
<div id="sheepButton">üêë</div>
<div id="message"></div>
<button id="restartButton">Lavati le mani e Ricomincia</button>

<script>
let score, timeLeft, gameOver;
let timer;
let poopProbability;
let poopTimeout = null;

const sheepButton = document.getElementById("sheepButton");
const scoreDisplay = document.getElementById("score");
const timeDisplay = document.getElementById("time");
const message = document.getElementById("message");
const restartButton = document.getElementById("restartButton");

function startGame(){
  score = 0;
  timeLeft = 30;
  gameOver = false;

  poopProbability = 0.12; // cacca pi√π frequente

  scoreDisplay.textContent = `üêëPecore: ${score}`;
  timeDisplay.textContent = `‚è±Ô∏è Tempo: ${timeLeft}`;
  message.textContent = "";
  restartButton.style.display = "none";

  clearInterval(timer);
  clearTimeout(poopTimeout);

  sheepButton.textContent = "üêë";

  timer = setInterval(() => {
    if (gameOver) return;

    timeLeft--;
    timeDisplay.textContent = `‚è±Ô∏è Tempo: ${timeLeft}`;

    // aumento pi√π veloce della cacca
    poopProbability = Math.min(0.40, poopProbability + 0.01);

    if (timeLeft <= 0) {
      endGame("Tempo finito!");
    }

  }, 1000);
}

sheepButton.addEventListener("click", tap);
sheepButton.addEventListener("touchstart", tap);

function tap(){
  if (gameOver) return;

  clearTimeout(poopTimeout);

  const current = sheepButton.textContent;

  if (current === "üí©") {
    endGame("Hai toccato la cacca!");
    return;
  }

  // cliccata una pecora ‚Üí punto
  score++;
  scoreDisplay.textContent = `üêëPecore: ${score}`;

  animateSymbol(() => {
    generateNextSymbol();
  });
}

function generateNextSymbol() {
  const isPoop = Math.random() < poopProbability;

  sheepButton.textContent = isPoop ? "üí©" : "üêë";

  // se esce la cacca, parte il timer perch√© sparisca da sola
  if (isPoop) {
    poopTimeout = setTimeout(() => {
      autoRemovePoop();
    }, 500); // mezzo secondo
  }
}

function autoRemovePoop() {
  if (gameOver) return;
  if (sheepButton.textContent !== "üí©") return;

  sheepButton.classList.add("poop-hide");

  setTimeout(() => {
    sheepButton.classList.remove("poop-hide");
    generateNextSymbol(); // appare il prossimo simbolo
  }, 400);
}

function animateSymbol(callback){
  sheepButton.style.transform = "scale(0)";
  sheepButton.style.opacity = "0";

  setTimeout(() => {
    sheepButton.style.transform = "scale(1)";
    sheepButton.style.opacity = "1";
    callback();
  }, 200);
}

function endGame(msg){
  gameOver = true;
  clearInterval(timer);
  clearTimeout(poopTimeout);
  message.textContent = `${msg} | Punteggio: ${score}`;
  restartButton.style.display = "block";
}

restartButton.addEventListener("click", startGame);

startGame();
</script>

</body>
</html>



